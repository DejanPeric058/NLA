
f = @(x) 1+(1.9./(0.9-x)+2./(1.4-x)+0.9./(1.9-x)+2.9./(2.9-x)+3.9./(3.7-x))./1000;

x0 = 1.4*1/3 + 1.9*2/3;

X = linspace(0,5,1000);

plot(X,f(X));

hold on

psi1 = @(x) (0.9./(1.9-x)+2.9./(2.9-x)+3.9./(3.7-x))./1000;
dpsi1 = @(x) (0.9./(1.9-x).^2+2.9./(2.9-x).^2+3.9./(3.7-x).^2)./1000;

psi2 = @(x) (1.9./(0.9-x)+2./(1.4-x))./1000;
dpsi2 = @(x)(1.9./(0.9-x).^2+2./(1.4-x).^2)./1000;

syms x c1 c1d c2 c2d
h1 = @(x,c1,c1d) c1./(1.9-x) + c1d;
dh1 = @(x,c1,c1d) c1d./(1.9-x).^2;

h2 = @(x,c2,c2d) c2./(1.4-x) + c2d;
dh2 = @(x,c1,c1d) c2d./(1.4-x).^2;
 
for i=1:1
   s1 = solve([h1(x0,c1,c1d)==psi1(x0);dh1(x0,c1,c1d)==dpsi1(x0)],c1,c1d);
   s2 = solve([h2(x0,c2,c2d)==psi2(x0);dh2(x0,c2,c2d)==dpsi2(x0)],c2,c2d);
   C1 = s1.c1;
   C1d = s1.c1d;
   C2 = s2.c2;
   C2d = s2.c2d;
   s3 = solve(1.*(1.9-x).*(1.4-x)+C1.*(1.4-x)+C1d.*(1.4-x).*(1.9-x)+C2.*(1.9-x)+C2d.*(1.9-x).*(1.4-x));
   x0 = double(s3(s3<1.9 & 1.4<s3))

end

